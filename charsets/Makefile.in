# $Id$
#
# Copyright (C) 1998 Thomas Roessler <roessler@guug.de>
#
#     This program is free software; you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation; either version 2 of the License, or
#     (at your option) any later version.
#
#     This program is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program; if not, write to the Free Software
#     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
#

SHELL=/bin/sh
sharedir=@sharedir@
CC=@CC@
CFLAGS=@CFLAGS@ -D_GEN_CHARSETS
LDFLAGS=@LDFLAGS@
srcdir=@srcdir@
top_srcdir=@top_srcdir@
VPATH=@srcdir@
@SET_MAKE@
INSTALL=@INSTALL@
LIBOBJS=@LIBOBJS@

subdir=charsets
distdir=@distdir@

DISTFILES = parse_i18n.c Makefile.in charsets.list charsets.alias gen_charsets

all: charsets.list

parse_i18n: parse_i18n.o $(LIBOBJS)
	$(CC) -o parse_i18n parse_i18n.o $(LIBOBJS)

strcasecmp.o $(LIBOBJS):
	cd .. && $(MAKE) $(LIBOBJS)
	for f in $(LIBOBJS) ; do ln ../$$f ./ || cp ../$$f ./ ; done

clean:
	-rm -f *.o *~ core parse_i18n

distclean: clean
	-rm -f Makefile

maintainer-clean: distclean
	-rm -f `cat charsets.list` charsets.list charsets.alias

charmaps charsets.list: parse_i18n
	cd $(srcdir) && sh ./gen_charsets

install: charsets.list
	$(srcdir)/../mkinstalldirs $(sharedir)/charsets
	( cd $(srcdir) && $(INSTALL) \
		-m 644 `cat charsets.list` $(sharedir)/charsets )
	$(INSTALL) -m 644 charsets.alias $(sharedir)/charsets/charsets.alias.dist
	test -f $(sharedir)/charsets/charsets.alias || 			\
	  $(INSTALL) -m 644 $(sharedir)/charsets/charsets.alias.dist	\
			$(sharedir)/charsets/charsets.alias

Makefile: ../config.status Makefile.in
	cd .. \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status

distdir dist: Makefile $(DISTFILES)
	for file in `cat charsets.list` $(DISTFILES) ; do	\
		ln $(srcdir)/$$file $(distdir) 2> /dev/null	\
			|| cp -p $(srcdir)/$$file $(distdir);	\
	done
